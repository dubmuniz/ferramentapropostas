<!doctype html><html lang="pt-br"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Humana Brasil — Gerador de Documentos</title>
<link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
<link rel="icon" href="assets/logo.svg"><link rel="stylesheet" href="style.css">
</head><body>
<header class="wrap">
  <img src="assets/logo.svg" alt="Humana Brasil" class="logo">
  <h1>Gerador de Ficha, Us to Us e Marco Lógico</h1>
  <p>Escreva o projeto, anexe o edital, selecione os formatos, baixe o XLSX.</p>
</header>

<main class="wrap">
  <form id="docForm">
    <label>Título do projeto
      <input name="title" required maxlength="140">
    </label>
    <label>Objetivo geral
      <textarea name="objetivo_geral" required rows="3"></textarea>
    </label>
    <label>Objetivos específicos
      <textarea name="objetivos_especificos" required rows="4"></textarea>
    </label>

    <fieldset>
      <legend>Formatos de saída</legend>
      <label><input type="checkbox" name="outputs" value="ficha" checked> Ficha de Identificação</label>
      <label><input type="checkbox" name="outputs" value="ustuus"> Us to Us</label>
      <label><input type="checkbox" name="outputs" value="marcologico"> Marco Lógico</label>
    </fieldset>

    <label>Anexar edital, PDF ou DOCX
      <input type="file" name="edital" accept=".pdf,.doc,.docx" required>
    </label>

    <button type="submit" id="submitBtn">Gerar XLSX</button>
    <p id="status" role="status" aria-live="polite"></p>
  </form>

  <div id="result" class="hidden">
    <a id="downloadLink" class="btn" href="#" download>Baixar XLSX</a>
  </div>
</main>

<footer class="wrap small">© Humana Povo para Povo Brasil</footer>
<script src="script.js"></script>
</body></html>
:root{--ink:#1b1b1b;--bg:#fafafa;--muted:#637074}
*{box-sizing:border-box}body{margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif;color:var(--ink);background:var(--bg)}
.wrap{max-width:900px;margin:0 auto;padding:20px}
header{text-align:center;padding-top:28px}.logo{height:54px}
h1{margin:14px 0 8px;font-size:26px}
p{color:var(--muted)}
form{background:#fff;border:1px solid #eee;border-radius:12px;padding:20px;box-shadow:0 2px 8px rgba(0,0,0,.04)}
label{display:block;margin:12px 0;font-weight:600}
input[type=file],input,textarea{width:100%;margin-top:6px;border:1px solid #d8dee4;border-radius:8px;padding:10px;font:inherit}
fieldset{border:1px solid #e3e8ee;border-radius:10px;padding:10px 12px;margin:12px 0}
legend{font-weight:600}
button{background:#1E7E34;color:#fff;border:0;border-radius:10px;padding:12px 16px;font-weight:600;cursor:pointer}
button:hover{filter:brightness(1.05)}
.btn{display:inline-block;background:#FFCB70;color:#111;padding:10px 14px;border-radius:10px;text-decoration:none;font-weight:600}
.hidden{display:none}.small{font-size:12px;color:#80888c}

const FORM = document.getElementById('docForm');
const STATUS = document.getElementById('status');
const RESULT = document.getElementById('result');
const LINK = document.getElementById('downloadLink');

// cole a URL do webhook do Make aqui
const WEBHOOK_URL = 'https://hook.make.com/SEU_WEBHOOK';

FORM.addEventListener('submit', async (e)=>{
  e.preventDefault();
  STATUS.textContent = 'Processando...';
  const formData = new FormData(FORM);
  // Capturar checkboxes manualmente para garantir array
  const outputs = Array.from(FORM.querySelectorAll('input[name="outputs"]:checked')).map(i=>i.value);
  outputs.forEach(v=>formData.append('outputs[]', v));

  try{
    const res = await fetch(WEBHOOK_URL, { method:'POST', body: formData });
    if(!res.ok) throw new Error('Falha no processamento');
    const data = await res.json(); // { downloadUrl: "..." }
    LINK.href = data.downloadUrl;
    RESULT.classList.remove('hidden');
    STATUS.textContent = 'Pronto';
  }catch(err){
    STATUS.textContent = 'Erro. Tente novamente.';
    console.error(err);
  }
});
